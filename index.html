<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>Demo Drawing Tool</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<link type="text/css" rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">
<style type="text/css">
	.quickset span {    
	    border-bottom: 1px dotted #000;
	    text-decoration: none;
			color: blue;
			cursor: pointer;
			padding: 0px 10px;
	}	
	</style>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js" ></script>
<script type="text/javascript" src="./pdfkit.js"> </script>
<script type="text/javascript" src="./blob-stream.js"> </script>
<script type="text/javascript" src="./demo.js"> </script>
</head>

<body>
	<script type="text/javascript">
		$(document).ready( function () {
			registerClickListeners();
			
			$(".quickset span").each(function () {
				
				$(this).click(function () {
					var updElems = $(this).parent().attr("data-elements").split(",");
					for (var i = 0; i < updElems.length; i++) {
						$("#" + updElems[i]).val($(this).attr("data-values").split(",")[i])
					}
					
				})
			});
			
			$("#btnPdf").click(function () {
				generatePdf();
			});
		});
		
		function generatePdf() {
			
			var doc = new PDFDocument();
			var stream = doc.pipe(blobStream());
			
		    var spacing, shapeWidth, shapeLength;

		    var pixelsPerInch = 300;

		    var selectedShape = getSelectedShape();
		    var margin = getMargin() * pixelsPerInch;

		    shapeWidth = getHoleWidth() * pixelsPerInch;
			shapeLength = getHoleLength() * pixelsPerInch;
		    spacing = getHorizontalCenter() * pixelsPerInch;

		    generateVectors(doc, doc.width, doc.height, shapeWidth, shapeLength, spacing, pixelsPerInch, selectedShape, margin);
			
			doc.end();
			
			
			var a = document.createElement("a");
		    document.body.appendChild(a);
		    a.style = "display: none";
		    return function (blob, fileName) {
		        var url = window.URL.createObjectURL(blob);
		        a.href = url;
		        a.download = fileName;
		        a.click();
		        window.URL.revokeObjectURL(url);
		    };
			
			stream.on('finish', function() {
				var blob = stream.toBlob('application/pdf');
				saveData(blob, 'holeProof.pdf');
			});
		}
	</script>
<div id="controls" class="container-fluid">
  <div class="row">
    <div class="col-md-2 form-group">
      <h3>
Hole Shape
</h3>
      <input type="radio" value="square" name="shape" id="shape_square">
      <label for="shape_square">Square</label>
      <input type="radio" value="circle" name="shape" id="shape_circle">
      <label for="shape_circle">Circle</label>
      <input type="radio" value="obround" name="shape" id="shape_obround">
      <label for="shape_obround">Obround</label>
      <input type="radio" value="hex" name="shape" id="shape_hex">
      <label for="shape_hex">Hexagonal</label>
      <h3>
Alignment
  </h3>
      <input type="radio" value="inline" name="alignment" id="alignment_inline" checked="CHECKED">
      <label for="alignment_inline">In-Line</label>
      <br>
      <input type="radio" value="staggered45" name="alignment" id="alignment_staggered45">
      <label for="alignment_staggered45">Staggered 45&deg;</label>
      <br>
      <input type="radio" value="staggered60" name="alignment" id="alignment_staggered60">
      <label for="alignment_staggered60">Staggered 60&deg;</label>
      <h3>
  Measurements
  </h3>
      <label for="holeWidth">Hole Width:</label>
      <input type="number" name="holeWidth" id="holeWidth" value="0.125" step="0.125">
      <br>
      <label for="holeLength">Hole Length</label>
      <input type="number" name="holeLength" id="holeLength" value="0.125" step="0.125">
      <br>
      <label for="horizontalCenter">Horizontal Center</label>
      <input type="number" name="horizontalCenter" id="horizontalCenter" value="0.1870" step="0.125">
      <br>
      <label for="margin">Margin</label>
      <input type="number" name="margin" id="margin" value="0.1" step="0.05">
      <br>
      <label for="openArea">Open Area</label>
      <input type="text" name="openArea" id="openArea" disabled="disabled">
      <br>
      <label for="holesPerSqareInch">Holes Per Square Inch</label>
      <input type="number" name="holesPerSquareInch" id="holesPerSquareInch" disabled="disabled">
			<br>
			<h3>Sheet Size</h3>
      <label for="sheetWidth">Sheet Width</label>
      <input type="number" name="sheetWidth" id="sheetWidth" value="24.0" step="0.125">
      <br>
      <label for="sheetLength">Sheet Length</label>
      <input type="number" name="sheetLength" id="sheetLength" value="24.0" step="0.125">
			<p class="quickset" data-elements="sheetWidth,sheetLength">Common sizes: <span data-values="24,24" id="sheet2424">24&quot;&nbsp;x&nbsp;24&quot;</span><span id="sheet48120" data-values="48,120">48&quot;&nbsp;x&nbsp;120&quot;</span>
				<span id="sheet4896" data-values="48,96">48&quot;&nbsp;x&nbsp;96&quot;</span><span id="60144" data-values="60,144">60&quot;&nbsp;x&nbsp;144&quot;</span><span id="80192" data-values="80,192">80&quot;&nbsp;x&nbsp;192&quot;</span></p>
		</div>
		<div class="col-lg-auto">
      <canvas id="canvas" style="border:1px solid #d3d3d3;">
        Your browser does not support the HTML5 canvas tag.</canvas>
		
		<input type="button" id="btnPdf" value="Generate PDF">

    </div>
  </div>
</div>

</body>
</html>
